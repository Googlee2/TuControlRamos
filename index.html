<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TuControl</title>

<style>
body {
    font-family: Arial, sans-serif;
    background:#f2f2f2;
    margin:0;
    padding:20px;
}
.card {
    max-width:420px;
    margin:auto;
    background:white;
    padding:20px;
    border-radius:10px;
    box-shadow:0 5px 15px rgba(0,0,0,.2);
}
button {
    width:100%;
    padding:10px;
    margin-top:10px;
    background:#0a7;
    border:none;
    color:white;
    font-size:16px;
    border-radius:5px;
}
input {
    width:100%;
    padding:8px;
    margin-top:10px;
}
img {
    max-width:100%;
    margin-top:10px;
    border-radius:6px;
}
.hidden { display:none; }
</style>
</head>

<body>

<div class="card" id="login">
    <h2>Ingreso empresa</h2>
    <input id="empresa" placeholder="Empresa">
    <input id="clave" type="password" placeholder="Clave">
    <button onclick="ingresar()">Ingresar</button>
</div>

<div class="card hidden" id="panel">
    <h2 id="empresaTitulo"></h2>

    <input type="file" id="fileInput" accept="image/*">
    <button onclick="subir()">Subir imagen</button>

    <div id="imagenes"></div>
</div>

<script>
const MAX_MOBILE_MB = 2;
const MAX_PC_MB = 10;

function esCelular() {
    return /Android|iPhone|iPad/i.test(navigator.userAgent);
}

function ingresar() {
    const emp = empresa.value.trim();
    const cla = clave.value.trim();

    if (!emp || !cla) {
        alert("Completa los datos");
        return;
    }

    localStorage.setItem("empresa", emp);
    login.classList.add("hidden");
    panel.classList.remove("hidden");
    empresaTitulo.textContent = "Empresa: " + emp;
    cargarImagenes();
}

function subir() {
    const file = fileInput.files[0];
    if (!file) return;

    const maxMB = esCelular() ? MAX_MOBILE_MB : MAX_PC_MB;
    const sizeMB = file.size / 1024 / 1024;

    if (sizeMB > maxMB) {
        alert(`En ${esCelular() ? "celulares" : "PC"} solo se permiten imÃ¡genes de hasta ${maxMB} MB`);
        return;
    }

    const reader = new FileReader();
    reader.onload = e => {
        const emp = localStorage.getItem("empresa");
        const imgs = JSON.parse(localStorage.getItem(emp) || "[]");
        imgs.push(e.target.result);
        localStorage.setItem(emp, JSON.stringify(imgs));
        cargarImagenes();
    };
    reader.readAsDataURL(file);
}

function cargarImagenes() {
    const emp = localStorage.getItem("empresa");
    const imgs = JSON.parse(localStorage.getItem(emp) || "[]");
    imagenes.innerHTML = "";
    imgs.forEach(src => {
        const img = document.createElement("img");
        img.src = src;
        imagenes.appendChild(img);
    });
}

window.onload = () => {
    const emp = localStorage.getItem("empresa");
    if (emp) {
        login.classList.add("hidden");
        panel.classList.remove("hidden");
        empresaTitulo.textContent = "Empresa: " + emp;
        cargarImagenes();
    }
};
</script>

</body>
</html>
